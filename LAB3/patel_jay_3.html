<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

<!--
  Run following command which will allow to load the data.csv file

  python -m SimpleHTTPServer
-->

<script>
var data = null;
d3.csv("../LAB2/data.csv", function(result){
    dataloaded(result);
});

function dataloaded(result){
    // Map the data into particular format
    data = result.map(function(d){
        return {
            name: d.Country,
            GDP: +d['GDP per Capita'].replace("$", "").replace(",", ""),
            Year: new Date(d.Year).getYear() + 1900
        }
    });
    // Filter the data for year "2012"
    data = data.filter(function(d) {
        return d.Year == 2012;
    });
}

function load_data() {

    var selection = d3.select("#list")
                      .selectAll("li")
                      .data(data, function(d) { return d.name; });

    //enter
    selection.enter().append("li");

    //exit
    selection.exit().remove();

    //Update
    selection.text(function(d) { return d.name + ": " + d.GDP });

    console.log(data);
}

</script>
<title>Lab 3</title>
</head>
<body>
  <button onclick="load_data()">Load Data</button>
  <ul id="list"></ul>
</body>
</html>
